<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Adote.Cão</title>
        <link rel="stylesheet" href="styleCadastro.css">
        <style>
           #logo {
              float: left;
              width: 50%;
              margin: 20px;
              padding: 20px;
              background-color: #fff;
              border: 1px solid #ccd0d5;
              border-radius: 4px;
              box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.08);
              max-width: 600px;
              box-sizing: border-box;
              }
              
              #logo img {
              max-width: 100%;
              }
              
              #logo p {
              font-size: 14px;
              line-height: 1.5;
              }
        </style>
        
        <body>
          <div id="main">
            <h1>Tela de criação de contas ADOTE.CÃO</h1>
            <label for="login">E-mail</label>
            <input type="text" id="login" name="login">
            <label for="password">Senha</label>
            <input type="password" id="password" name="password">
            <br>
            <input type="checkbox" id="isOng" name="isOng">
            <label for="isOng">Sou dono de uma ONG</label>
            <br>
            <div id="formContainer">
              <h2>Dados pessoas</h2>
              <label for="name">Nome</label>
              <input type="text" name="name" id="name">
              <label for="cpf">CPF</label>
              <input type="text" name="cpf" id="cpf">
              <label for="birht">Data de Nascimento</label>
              <input type="date" name="birth" id="birth">
              <label for="state">Estado</label>
              <input type="text" name="state" id="state">
              <label for="city">Cidade</label>
              <input type="text" name="city" id="city">
              <label for="neighborhood">Bairro</label>
              <input type="text" name="neighborhood" id="neighborhood">
              <label for="cep">CEP</label>
              <input type="text" name="cep" id="cep">

            </div>
            <button onclick="createAccount()">Cadastrar</button>
          </div>
          <div id="logo">
            <img src="images\adote_Cao_Logo.png">
            <p>Adote.cão é um projeto que visa auxiliar ONGs a reduzir o número de animais sem lar criando um local perfeito para você que quer adotar um animal que se encaixe em seu estilo de vida.</p>
          </div>
        </body>



        <script>
            let isOng = document.getElementById("isOng");
            isOng.addEventListener("change", showOngOptions);
            function showOngOptions() {
                let formContainer = document.getElementById("formContainer");

                // EXIBICAO DE OPCOES DE ONG
                if (isOng.checked) {
                    console.log("MARCADO"); 
                    // NOME DA ONG
                    let ongName = document.createElement("input");
                    ongName.setAttribute("id","ongName");
                    let labelOngName = document.createElement("label");
                    labelOngName.setAttribute("for", "ongName");
                    labelOngName.setAttribute("id","labelOngNameId")
                    labelOngName.innerText = "Nome da Ong"
                    formContainer.appendChild(labelOngName);
                    formContainer.appendChild(ongName);

                } else {
                    let ongName = document.getElementById("ongName");
                    let labelOngName = document.getElementById("labelOngNameId");
                    ongName.remove();
                    labelOngName.remove();
                }
            }

            function createAccount(event) {

                let httpRequest = new XMLHttpRequest();
                const URL_SERVLET_REGISTER = "http://localhost:8080/adoteCaoProjeto/RegisterServlet";
                httpRequest.onreadystatechange=function(){
                  if(httpRequest.readyState === XMLHttpRequest.DONE){
                    if(httpRequest.status === 200){
                      window.alert("Conta Criada com sucesso!");
                              setTimeout(() => {
                                window.location.replace("http://127.0.0.1:5500/login.html")
                              }, 3000);
                    }else if(httpRequest.status === 409){
                      window.alert(httpRequest.responseText);
                    }
                  }
                }
                httpRequest.open("POST", URL_SERVLET_REGISTER, true);
                httpRequest.setRequestHeader('Content-type','application/x-www-form-urlencoded');
                let login = document.getElementById("login").value;
                let password = document.getElementById("password").value;
                let name = document.getElementById("name").value;
                let cpf = document.getElementById("cpf").value;
                let birth = document.getElementById("birth").value;
                let state = document.getElementById("state");

                let isOng = document.getElementById("isOng").checked;
                
                if(isOng == true){  
                let ongName = document.getElementById("ongName").value;
                let state = document.getElementById("state").value;
                let city = document.getElementById("city").value;
                let neighborhood = document.getElementById("neighborhood").value;
                let cep = document.getElementById("cep").value;

                console.log(login, password, name, cpf, birth, ongName);
                httpRequest.send("login="+login+"&password="+password+"&name="+name+"&cpf="+cpf+"&birth="+birth+"&isOng="+isOng+"&ongName="+ongName+
                "&state="+state+"&city="+city+"&neighborhood="+neighborhood+"&cep="+cep);
                
                }else if (isOng == false){
                console.log(login, password, name, cpf, birth, isOng);
                httpRequest.send("login="+login+"&password="+password+"&name="+name+"&cpf="+cpf+"&birth="+birth+"&isOng="+isOng);
                }      
            }
        </script>
    </body>
</html>
